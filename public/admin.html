<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<script src="/socket.io/socket.io.js"></script>
<style>
body{margin:0;padding:0;font-family:Arial,sans-serif;background:#0b1e2d;color:white;}
header{background:#1b3a57;padding:15px;text-align:center;font-size:26px;color:#00c3ff;font-weight:bold;}
button{padding:10px;margin:5px;border-radius:5px;border:none;background:#00c3ff;color:white;cursor:pointer;}
button:hover{background:#0099cc;}
#userList, #boardList{margin:10px;padding:10px;background:#145374;border-radius:5px;}
</style>
</head>
<body>
<header>Admin Panel</header>

<section>
<h3>Spieler / Admins verwalten</h3>
<input id="newUser" placeholder="Username">
<input id="newPass" placeholder="Passwort">
<select id="newRole"><option value="player">Spieler</option><option value="editor">Editor</option><option value="admin">Admin</option></select>
<button onclick="addUser()">Hinzuf√ºgen</button>
<div id="userList"></div>
</section>

<section>
<h3>Boards verwalten</h3>
<div id="boardList"></div>
<button onclick="openQuizWindow()">Quiz starten</button>
</section>

<script>
const socket = io();
let boardData = null;

function addUser(){
  const username=document.getElementById("newUser").value;
  const password=document.getElementById("newPass").value;
  const role=document.getElementById("newRole").value;
  socket.emit('addUser',{username,password,role});
}

socket.on('userListUpdate', users=>{
  const ul = document.getElementById("userList");
  ul.innerHTML="";
  users.forEach(u=>{
    ul.innerHTML += `<div>${u.username} - ${u.role} - Score: ${u.score}</div>`;
  });
});

socket.on('boardData', data=>{
  boardData = data;
  const bl = document.getElementById("boardList");
  bl.innerHTML="";
  data.categories.forEach((cat,idx)=>{
    bl.innerHTML += `<div>${cat.name}</div>`;
  });
});

function openQuizWindow(){
  if(!boardData){alert("Kein Board geladen"); return;}
  const quizWindow = window.open("/quiz.html","QuizLeitung","width=1200,height=800");
  quizWindow.boardData = boardData;
}

socket.emit('getBoard');
socket.emit('getUsers');
</script>
</body>
</html>
